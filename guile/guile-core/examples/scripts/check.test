#!/bin/sh

# must be run from this directory
guile=${GUILE-../../libguile/guile}
if [ -x $guile ] ; then
    :
else
    echo could not find guile interpreter.
    echo '(are you running this script from' `dirname $0` '?)'
    echo GUILE env var: ${GUILE-not set}
    exit 1
fi

set -e

#
# simple-hello.scm
#
GUILE_LOAD_PATH=../.. $guile -s simple-hello.scm > TMP
cat <<EOF | diff -u - TMP
Hello, World!
EOF
rm -f TMP

#
# hello
#
GUILE_LOAD_PATH=../.. $guile -s hello > TMP
echo "Hello, World!" | diff -u - TMP
rm -f TMP

GUILE_LOAD_PATH=../.. $guile -s hello --version > TMP
echo "hello 0.0.1" | diff -u - TMP
rm -f TMP

GUILE_LOAD_PATH=../.. $guile -s hello --help > TMP
cat <<EOF | diff -u - TMP
Usage: hello [options...]
  --help, -h           Show this usage information
  --version, -v        Show version information
EOF
rm -f TMP

#
# fact
#
case `GUILE_LOAD_PATH=../.. $guile -s fact 5` in 120) ;; *) echo $0: error: fact 5 ;; esac

# check.test ends here
