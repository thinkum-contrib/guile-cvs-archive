# Makefile for libgtcltk
# Copyright (C) 1994 Free Software Foundation, Inc.
# 
# This file is part of GNU Gtcltk
# 
# GNU Gtcltk is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
# 
# GNU Gtcltk is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with GNU SED; see the file COPYING.  If not, write to
# the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.

SHELL = /bin/sh

srcdir = @srcdir@
VPATH = @srcdir@
prefix = @prefix@
exec_prefix = $(prefix)
bindir = $(exec_prefix)/bin
libdir = $(exec_prefix)/lib
glsdir = $(exec_prefix)/lib/gls
includedir = $(prefix)/include
infodir = $(prefix)/info

#### Start of system configuration section. ####

CC = @CC@
INSTALL = @INSTALL@
DEFS = @DEFS@
CFLAGS = @CFLAGS@
X_CFLAGS = @X_CFLAGS@

ALL_CFLAGS = $(CFLAGS) $(X_CFLAGS) -I. -I$(srcdir)/../libguile -I../libguile -I$(srcdir)/../gtcl -I$(srcdir)/../gtk
AR = ar
AR_FLAGS = rc
RANLIB = @RANLIB@
source=guile-tcl.c guile-tk.c 
xfiles=guile-tcl.x guile-tk.x 
headers=guile-tcl.h guile-tk.h
ancillary= .cvsignore \
	   COPYING \
	   ChangeLog \
	   GUILE.vars.in \
	   Makefile.in \
	   configure \
	   configure.in

distfiles=$(source) $(headers) $(ancillary) 
libobjs=guile-tcl.o guile-tk.o
.SUFFIXES:
.SUFFIXES: .o .c .h .ps .dvi .info .texinfo .scm .cd .x

.c.x:
	$(CC) $(ALL_CFLAGS) -DSCM_MAGIC_SNARFER -E $< | grep "^%%%" | sed -e "s/^%%%//" > $@ ; \

.c.o:
	$(CC) -c $(ALL_CFLAGS) $(DEFS) -I$(srcdir) $<

all: libgtcltk.a

install: all
	test -d $(libdir) || mkdir $(libdir)
	test -d $(glsdir) || mkdir $(glsdir)
	test -d $(includedir) || mkdir $(includedir)
	$(INSTALL) libgtcltk.a $(libdir)/libgtcltk.a
	$(RANLIB) $(libdir)/libgtcltk.a
	$(INSTALL) $(srcdir)/guile-tk.h $(includedir)/guile-tk.h
	$(INSTALL) $(srcdir)/guile-tcl.h $(includedir)/guile-tcl.h

uninstall:
	-rm -f $(libdir)/libgtcltk.a
	-rm -f $(includedir)/guile-tk.h
	-rm -f $(includedir)/guile-tcl.h

clean:
	-rm -f $(libobjs) $(xfiles) libgtcltk.a

distclean: clean
	-rm Makefile config.status

mostlyclean: clean

realclean: distclean

TAGS:
	etags $(source)

info:

install-info:

clean-info:

dvi:

check:

# The `dist' target in the top-level Makefile uses this `dist-dir'
# target to select the appropriate files for distribution from the
# directory containing this Makefile.
.PHONY: dist-dir
dist-dir:
	mkdir ${DISTDIR}
	for f in $(distfiles); do \
	  ln ${srcdir}/$$f ${DISTDIR}; \
	done
	mkdir ${DISTDIR}/PLUGIN
	for f in REQ greet guile.config guile.inits guile.libs; do \
	  ln ${srcdir}/PLUGIN/$$f ${DISTDIR}/PLUGIN; \
	done

libgtcltk.a: $(libobjs)
	rm -f libgtcltk.a
	$(AR) $(AR_FLAGS) libgtcltk.a $(libobjs)
	$(RANLIB) libgtcltk.a

guile-tcl.o: guile-tcl.c guile-tcl.h guile-tcl.x
guile-tk.o: guile-tk.c guile-tk.h guile-tcl.h guile-tk.x
